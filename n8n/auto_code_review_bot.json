{
  "name": "Auto Code Review Bot",
  "nodes": [
    {
      "parameters": {
        "events": [
          "pull_request"
        ],
        "owner": {
          "__rl": true,
          "value": "YOUR_GITHUB_USERNAME",
          "mode": "name"
        },
        "repository": {
          "__rl": true,
          "value": "YOUR_REPO_NAME",
          "mode": "name"
        }
      },
      "id": "1",
      "name": "GitHub Trigger",
      "type": "n8n-nodes-base.githubTrigger",
      "typeVersion": 1,
      "position": [
        240,
        300
      ],
      "webhookId": "auto-generated"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict"
          },
          "conditions": [
            {
              "id": "1",
              "leftValue": "={{ $json.action }}",
              "rightValue": "opened",
              "operator": {
                "type": "string",
                "operation": "equals"
              }
            },
            {
              "id": "2",
              "leftValue": "={{ $json.action }}",
              "rightValue": "synchronize",
              "operator": {
                "type": "string",
                "operation": "equals"
              }
            }
          ],
          "combinator": "or"
        }
      },
      "id": "2",
      "name": "Filter PR Events",
      "type": "n8n-nodes-base.if",
      "typeVersion": 2,
      "position": [
        460,
        300
      ]
    },
    {
      "parameters": {
        "method": "GET",
        "url": "=https://api.github.com/repos/{{ $json.repository.owner.login }}/{{ $json.repository.name }}/pulls/{{ $json.number }}/files",
        "authentication": "predefinedCredentialType",
        "nodeCredentialType": "githubApi",
        "options": {}
      },
      "id": "3",
      "name": "Get PR Files",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        680,
        300
      ]
    },
    {
      "parameters": {
        "jsCode": "const files = $input.all();\nconst issues = [];\nconst suggestions = [];\n\nfiles.forEach(file => {\n  const filename = file.json.filename;\n  const patch = file.json.patch || '';\n  const additions = file.json.additions;\n  \n  // Check 1: Console.log\n  if (patch.includes('console.log')) {\n    issues.push(`ðŸ” **${filename}**: Remove console.log statements`);\n  }\n  \n  // Check 2: Debugger\n  if (patch.includes('debugger')) {\n    issues.push(`ðŸ› **${filename}**: Remove debugger statement`);\n  }\n  \n  // Check 3: TODO/FIXME\n  if (patch.match(/TODO|FIXME/i)) {\n    issues.push(`ðŸ“ **${filename}**: TODO/FIXME found`);\n  }\n  \n  // Check 4: Secrets\n  if (patch.match(/api[_-]?key|password|secret|token/i)) {\n    issues.push(`ðŸ”’ **${filename}**: Potential secret detected`);\n  }\n  \n  // Check 5: Large files\n  if (additions > 500) {\n    suggestions.push(`ðŸ“¦ **${filename}**: Large file (+${additions} lines)`);\n  }\n  \n  // Check 6: Missing error handling\n  if (patch.includes('fetch(') && !patch.includes('catch')) {\n    suggestions.push(`âš ï¸ **${filename}**: fetch() without .catch()`);\n  }\n});\n\n// Generate comment\nlet comment = '## ðŸ¤– Automated Code Review\\n\\n';\n\nif (issues.length === 0 && suggestions.length === 0) {\n  comment += 'âœ… **No issues found!** Code looks good.\\n';\n} else {\n  if (issues.length > 0) {\n    comment += '### âŒ Issues Found\\n\\n';\n    issues.forEach(i => comment += `- ${i}\\n`);\n    comment += '\\n';\n  }\n  if (suggestions.length > 0) {\n    comment += '### ðŸ’¡ Suggestions\\n\\n';\n    suggestions.forEach(s => comment += `- ${s}\\n`);\n  }\n}\n\ncomment += '\\n---\\n_Automated review by n8n bot_';\n\nconst triggerData = $('GitHub Trigger').item.json;\n\nreturn [{\n  json: {\n    comment: comment,\n    prNumber: triggerData.number,\n    repo: triggerData.repository.name,\n    owner: triggerData.repository.owner.login\n  }\n}];"
      },
      "id": "4",
      "name": "Analyze Code",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        900,
        300
      ]
    },
    {
      "parameters": {
        "method": "POST",
        "url": "=https://api.github.com/repos/{{ $json.owner }}/{{ $json.repo }}/issues/{{ $json.prNumber }}/comments",
        "authentication": "predefinedCredentialType",
        "nodeCredentialType": "githubApi",
        "sendBody": true,
        "bodyParameters": {
          "parameters": [
            {
              "name": "body",
              "value": "={{ $json.comment }}"
            }
          ]
        },
        "options": {}
      },
      "id": "5",
      "name": "Post Review Comment",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        1120,
        300
      ]
    }
  ],
  "connections": {
    "GitHub Trigger": {
      "main": [
        [
          {
            "node": "Filter PR Events",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Filter PR Events": {
      "main": [
        [
          {
            "node": "Get PR Files",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get PR Files": {
      "main": [
        [
          {
            "node": "Analyze Code",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Analyze Code": {
      "main": [
        [
          {
            "node": "Post Review Comment",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "pinData": {},
  "settings": {
    "executionOrder": "v1"
  },
  "staticData": null,
  "tags": [],
  "triggerCount": 0,
  "updatedAt": "2026-02-07T23:23:00.000Z",
  "versionId": "1"
}

